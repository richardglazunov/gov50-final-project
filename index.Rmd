---
title: "Gov 50 Final Project"
author: "Richard Glazunov"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts

In my research, I will seek to discover if hate crimes in New York City are more frequent during certain times of the year. I hypothesize that during the months of January - March hate crimes will be experienced at a higher rate than any other time of the year. This is in part due to the fact it will be after the holidays, the weather will be unpleasant, and the amount of daylight hours will be at its lowest point. Heightened emotions, social tensions, and public events associated with holidays, cultural celebrations, weather, amount of daylight, or specific historical anniversaries are all factors that may influence the rate of hate crimes. I will be using a data set provided by the NYPD on hate crimes. The explanatory variable of interest is the time of year, measured in months, with 12 levels corresponding to each month. The outcome variable will be the frequency of hate crimes, measured as the count of reported hate crimes in a given month or season. We will observe data over several years. The observed pattern would be confirmed if there is a clear statistically significant and consistent increase in the number of hate crimes during specific months or seasons. Conversely, if there is no consistent and clear obvious increase in hate crimes during specific seasons then we can infer that the time of year has no impact on the amount of hate crimes committed. 

```{r}
hatecrimes <- read.csv("NYPD_Hate_Crimes.csv")
```
## Libraries

```{r}
library(ggplot2)
library(dplyr)
library(tidyverse)
```


## Barplot for Hate Crimes for the whole data set.

```{r}
totalcrimes <- hatecrimes |>
  group_by(Month.Number) |>
  summarize(Total_Arrests_Per_Month = sum(n())) 

month_order <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun",
                 "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
totalcrimes$Month.Number <- factor(totalcrimes$Month.Number, levels = 1:12, labels = month_order)

totalcrimesplot <- totalcrimes |>
  ggplot(aes(x = Month.Number, y = Total_Arrests_Per_Month)) +
           geom_bar(stat = "identity", fill = "indianred1", alpha = 0.5) +
  labs(title = "Total Crimes By Month",
       x = "Months",
       y = "Number of Crimes")
  
totalcrimesplot
```


### Top 3 Months for Hate Crimes and Bottom 3 Months for Hate Crimes. 

```{r}

month_names <- c("January", "February", "March", "April", "May", "June",
                 "July", "August", "September", "October", "November", "December")

summary_table <- hatecrimes |>
  group_by(Month.Number) |>
  summarize(Average_Crimes = mean(n())) |>
  arrange(desc(Average_Crimes)) 


top_3_highest <- summary_table |>
  top_n(3, wt = Average_Crimes)

bottom_3_lowest <- summary_table |>
  top_n(-3, wt = Average_Crimes)


final_table <- bind_rows(top_3_highest, bottom_3_lowest) |>
  mutate(Month= month_names[Month.Number]) |>
  select(Month, everything()) |>
  select(-Month.Number) |>
  knitr::kable()

final_table
```

### Highest Crime Month for 2019, 2020, 2021  

```{r}
TOPCRIMES <- hatecrimes |>
  mutate(Year = Complaint.Year.Number)

top_month_2019 <- TOPCRIMES |>
  filter(Year == 2019) |>
  group_by(Year, Month.Number) |>
  summarize(Total_Crimes = n()) |>
  arrange(desc(Total_Crimes)) |>
  slice(1)

top_month_2020 <- TOPCRIMES |>
  filter(Year == 2020) |>
  group_by(Year, Month.Number) |>
  summarize(Total_Crimes = n()) |>
  arrange(desc(Total_Crimes)) |>
  slice(1)

top_month_2021 <- TOPCRIMES |>
  filter(Year == 2021) |>
  group_by(Year, Month.Number) |>
  summarize(Total_Crimes = n()) |>
  arrange(desc(Total_Crimes)) |>
  slice(1)

resultbox <- bind_rows(top_month_2019, top_month_2020, top_month_2021)
resultbox$Month <- month.name[resultbox$Month.Number]

resultbox <- resultbox |>
  select(-Month.Number) |>
  select(Year, Month, Total_Crimes) |>
  knitr::kable()

resultbox
```

## Current Analysis of Data.

After examining the dataset, a correlation between hate crimes and warmer months becomes apparent. The months registering the highest number of hate crimes were March, June, and May. This trend suggests that as temperatures rise and daylight extends, more individuals spend time outdoors, potentially leading to an increased risk of hate crimes. Conversely, the months with the lowest count of hate crimes were October, November, and December. This decline aligns with the decrease in temperatures and shorter daylight hours, resulting in fewer outdoor interactions among people and consequently a decrease in reported hate crimes. With the current data presented and it being rather consistent over the years I would argue that the main idea of my hypothesis is wrong. The colder months (especially the ones with the least amount of sunlight) contribute to a decrease in crime while warmer months and ample sunlight provide people the opportunity to interact with each other more frequently and subsequently get into more altercations. 
